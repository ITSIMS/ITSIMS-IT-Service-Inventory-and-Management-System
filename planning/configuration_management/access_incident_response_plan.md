# План поддержки и реагирования на инциденты доступа (RBAC)

| Дата       | Номер версии | Автор  | Ссылка на задачу                                                           | Комментарий                                     |
| ---------- | ------------ | ------ | -------------------------------------------------------------------------- | ----------------------------------------------- |
| 2026-02-18 | v1.0         | Ловков | [2026-02-18_Lovkov.md](../../task-tracker/3_done/2026-02-18_Lovkov.md) | Базовый план поддержки модуля ролевого доступа |



## 1. Цель

Документ определяет порядок поддержки модуля ролевого доступа ITSIMS на этапе верификации:
- классификацию инцидентов;
- SLA по реакции и восстановлению;
- схему эскалации;
- чеклист диагностики типовых проблем.



## 2. Область применения

План применяется для инцидентов, связанных с:
- несанкционированным доступом;
- ошибками назначения/отзыва ролей;
- отказами авторизации и проверок прав;
- ошибками фильтрации контента по ролям.

Связанные артефакты:
- [Кандидат 2: ролевая модель доступа](../../candidate_2_rbac.md)
- [Регламент Git-процесса для верификации](../repository/verification_git_regulation.md)



## 3. Классификация инцидентов

| Приоритет | Критерий | Пример |
| --------- | -------- | ------ |
| `P1` (Критический) | Риск компрометации данных или массовая недоступность авторизации | Обычный сотрудник получает административные права |
| `P2` (Высокий) | Сбой критичной функции доступа без утечки данных | Невозможно назначить права пользователю на сервис |
| `P3` (Средний) | Частичный функциональный дефект с обходным решением | Некорректно скрываются UI-элементы для одной роли |
| `P4` (Низкий) | Некритичный дефект без влияния на безопасность | Ошибка текста в сообщении «Доступ запрещен» |



## 4. SLA реакции и восстановления

| Приоритет | Подтверждение инцидента (TTA) | Начало работ | Целевое восстановление (TTR) |
| --------- | ----------------------------- | ------------ | ----------------------------- |
| `P1` | до 15 минут | немедленно | до 4 часов |
| `P2` | до 30 минут | до 1 часа | до 8 часов |
| `P3` | до 4 часов | до 1 рабочего дня | до 3 рабочих дней |
| `P4` | до 1 рабочего дня | до 2 рабочих дней | до 5 рабочих дней |

Правила:
- инциденты `P1`/`P2` фиксируются в приоритетном канале команды;
- для `P1` обязательна синхронизация статуса не реже 1 раза в 30 минут;
- после восстановления выполняется пост-анализ причины.



## 5. Схема эскалации

| Этап | Роль | Ответственность | Триггер перехода |
| ---- | ---- | --------------- | ---------------- |
| L1 | Исполнитель (Ловков К.И.) | Первичная диагностика, подтверждение приоритета, сбор фактов | Инцидент зарегистрирован |
| L2 | Верификатор (Зацепилин А.В.) | Проверка корректности воспроизведения, оценка влияния на требования | Неочевидная причина/высокий риск |
| L3 | Тимлид (Баранов А.Т.) | Решение о срочных изменениях, приоритизация исправлений, финальное согласование | `P1`/`P2` или срыв SLA |



## 6. Чеклист диагностики типовых ошибок прав доступа

### 6.1 Проверка данных и ролей

- [ ] У пользователя корректная глобальная роль (system scope)
- [ ] Для сервиса назначена корректная локальная роль (`service_permissions`)
- [ ] Нет дублей/конфликтов назначений в таблице прав
- [ ] Пользователь не находится в статусе блокировки

### 6.2 Проверка API и авторизации

- [ ] Endpoint соответствует ожидаемому уровню доступа
- [ ] Проверена валидность токена (срок, подпись, claims)
- [ ] Подтвержден ожидаемый HTTP-статус (`401`/`403`/`200`)
- [ ] Логика middleware прав воспроизводится на тестовом кейсе

### 6.3 Проверка UI и фильтрации контента

- [ ] Скрытие элементов интерфейса соответствует роли
- [ ] Каталог сервисов отфильтрован по фактическим правам
- [ ] Документация ограничена по правилам `user_docs`
- [ ] Сообщение об отказе доступа отображается корректно



## 7. Порядок восстановления и закрытия инцидента

1. Подтвердить приоритет и зафиксировать минимальный набор фактов.
2. Внести исправление в ветке задачи согласно регламенту верификации.
3. Проверить исправление на негативном и позитивном сценариях.
4. Зафиксировать результат в отчете верификации/матрице покрытия.
5. Закрыть инцидент с указанием первопричины и предотвращающих мер.
